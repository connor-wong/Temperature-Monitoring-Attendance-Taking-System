{"ast":null,"code":"import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport styles from '@patternfly/react-styles/css/components/Menu/menu';\nimport { css } from '@patternfly/react-styles';\nimport { getOUIAProps, getDefaultOUIAId } from '../../helpers';\nimport { MenuContext } from './MenuContext';\n\nclass MenuBase extends React.Component {\n  constructor() {\n    super(...arguments);\n    this.menuRef = React.createRef();\n    this.activeMenu = null;\n    this.state = {\n      ouiaStateId: getDefaultOUIAId(Menu.displayName),\n      searchInputValue: '',\n      transitionMoveTarget: null\n    };\n\n    this.handleDrilldownTransition = event => {\n      let ref = this.menuRef;\n\n      if (this.props.innerRef) {\n        ref = this.props.innerRef;\n      }\n\n      if (!ref.current || ref.current !== event.target.closest('.pf-c-menu') && !Array.from(ref.current.getElementsByClassName('pf-c-menu')).includes(event.target.closest('.pf-c-menu'))) {\n        return;\n      }\n\n      if (event.propertyName === 'visibility') {\n        if (this.state.transitionMoveTarget) {\n          this.state.transitionMoveTarget.focus();\n          this.setState({\n            transitionMoveTarget: null\n          });\n        } else {\n          const nextMenu = ref.current.querySelector('#' + this.props.activeMenu) || ref.current || null;\n          const nextTarget = Array.from(nextMenu.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')))[0].firstChild;\n          nextTarget.focus();\n          nextTarget.tabIndex = 0;\n        }\n      }\n    };\n\n    this.handleKeys = event => {\n      const isDrilldown = this.props.containsDrilldown;\n      let ref = this.menuRef;\n\n      if (this.props.innerRef) {\n        ref = this.props.innerRef;\n      }\n\n      if (!ref.current || ref.current !== event.target.closest('.pf-c-menu') && !Array.from(ref.current.getElementsByClassName('pf-c-menu')).includes(event.target.closest('.pf-c-menu')) || event.target.tagName === 'INPUT') {\n        return;\n      }\n\n      event.stopImmediatePropagation();\n      const activeElement = document.activeElement;\n\n      if (event.target.closest('.pf-c-menu') !== this.activeMenu && !event.target.classList.contains('pf-c-breadcrumb__link')) {\n        this.activeMenu = event.target.closest('.pf-c-menu');\n      }\n\n      const parentMenu = this.activeMenu;\n      const key = event.key;\n      let moveFocus = false;\n      let moveTarget = null;\n      let currentIndex = -1;\n      const validMenuItems = isDrilldown ? Array.from(parentMenu.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider'))) : Array.from(parentMenu.getElementsByTagName('LI')).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')));\n      const isFromBreadcrumb = activeElement.classList.contains('pf-c-breadcrumb__link') || activeElement.classList.contains('pf-c-dropdown__toggle');\n\n      if (key === ' ' || key === 'Enter') {\n        event.preventDefault();\n\n        if (isDrilldown && !isFromBreadcrumb) {\n          const isDrillingOut = activeElement.closest('li').classList.contains('pf-m-current-path');\n\n          if (isDrillingOut && parentMenu.parentElement.tagName === 'LI') {\n            activeElement.tabIndex = -1;\n            parentMenu.parentElement.firstChild.tabIndex = 0;\n            this.setState({\n              transitionMoveTarget: parentMenu.parentElement.firstChild\n            });\n          } else {\n            if (activeElement.nextElementSibling && activeElement.nextElementSibling.classList.contains('pf-c-menu')) {\n              const childItems = Array.from(activeElement.nextElementSibling.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')));\n              activeElement.tabIndex = -1;\n              childItems[0].firstChild.tabIndex = 0;\n              this.setState({\n                transitionMoveTarget: childItems[0].firstChild\n              });\n            }\n          }\n        }\n\n        document.activeElement.click();\n      }\n\n      if (['ArrowUp', 'ArrowDown'].includes(key)) {\n        validMenuItems.forEach((menuItem, index) => {\n          if (activeElement.parentElement === menuItem || activeElement.closest('ol') && activeElement.closest('ol').firstChild === menuItem) {\n            const increment = key === 'ArrowUp' ? -1 : 1;\n            currentIndex = index + increment;\n\n            if (currentIndex >= validMenuItems.length) {\n              currentIndex = 0;\n            }\n\n            if (currentIndex < 0) {\n              currentIndex = validMenuItems.length - 1;\n            }\n\n            moveFocus = true;\n            moveTarget = validMenuItems[currentIndex].firstChild;\n            event.preventDefault();\n          }\n        });\n      }\n\n      if (['ArrowLeft', 'ArrowRight'].includes(key)) {\n        event.preventDefault();\n\n        if (isFromBreadcrumb) {\n          return;\n        }\n\n        let nextSibling;\n\n        if (key === 'ArrowLeft') {\n          nextSibling = activeElement.previousElementSibling;\n        } else {\n          nextSibling = activeElement.nextElementSibling;\n        }\n\n        if (nextSibling) {\n          if (['A', 'BUTTON'].includes(nextSibling.tagName)) {\n            moveFocus = true;\n            moveTarget = nextSibling;\n          }\n        }\n      }\n\n      if (moveFocus && moveTarget) {\n        activeElement.tabIndex = -1;\n        moveTarget.tabIndex = 0;\n        moveTarget.focus();\n      }\n    };\n  }\n\n  componentDidMount() {\n    window.addEventListener('keydown', this.props.isRootMenu ? this.handleKeys : null);\n    window.addEventListener('transitionend', this.props.isRootMenu ? this.handleDrilldownTransition : null);\n    let ref = this.menuRef;\n\n    if (this.props.innerRef) {\n      ref = this.props.innerRef;\n    }\n\n    const firstItem = ref.current.querySelector('button, a');\n\n    if (firstItem) {\n      firstItem.tabIndex = 0;\n    }\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('keydown', this.handleKeys);\n    window.removeEventListener('transitionend', this.handleDrilldownTransition);\n  }\n\n  render() {\n    const _a = this.props,\n          {\n      'aria-label': ariaLabel,\n      id,\n      children,\n      className,\n      onSelect,\n      selected = null,\n      onActionClick,\n      ouiaId,\n      ouiaSafe,\n      containsFlyout,\n      containsDrilldown,\n      isMenuDrilledIn,\n      drilldownItemPath,\n      drilledInMenus,\n      onDrillIn,\n      onDrillOut,\n      onGetMenuHeight,\n      parentMenu = null,\n      activeItemId = null,\n      innerRef,\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      isRootMenu,\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      activeMenu\n    } = _a,\n          props = __rest(_a, ['aria-label', \"id\", \"children\", \"className\", \"onSelect\", \"selected\", \"onActionClick\", \"ouiaId\", \"ouiaSafe\", \"containsFlyout\", \"containsDrilldown\", \"isMenuDrilledIn\", \"drilldownItemPath\", \"drilledInMenus\", \"onDrillIn\", \"onDrillOut\", \"onGetMenuHeight\", \"parentMenu\", \"activeItemId\", \"innerRef\", \"isRootMenu\", \"activeMenu\"]);\n\n    const _isMenuDrilledIn = isMenuDrilledIn && isMenuDrilledIn || drilledInMenus && drilledInMenus.includes(id) || false;\n\n    return React.createElement(MenuContext.Provider, {\n      value: {\n        menuId: id,\n        parentMenu: parentMenu ? parentMenu : id,\n        onSelect,\n        onActionClick,\n        activeItemId,\n        selected,\n        drilledInMenus,\n        drilldownItemPath,\n        onDrillIn,\n        onDrillOut,\n        onGetMenuHeight\n      }\n    }, React.createElement(\"div\", Object.assign({\n      id: id,\n      className: css(styles.menu, containsFlyout && styles.modifiers.flyout, containsDrilldown && styles.modifiers.drilldown, _isMenuDrilledIn && styles.modifiers.drilledIn, className),\n      \"aria-label\": ariaLabel || containsFlyout ? 'Local' : 'Global',\n      ref: innerRef || this.menuRef || null\n    }, getOUIAProps(Menu.displayName, ouiaId !== undefined ? ouiaId : this.state.ouiaStateId, ouiaSafe), props), children));\n  }\n\n}\n\nMenuBase.defaultProps = {\n  ouiaSafe: true,\n  isRootMenu: true\n};\nexport const Menu = React.forwardRef((props, ref) => React.createElement(MenuBase, Object.assign({}, props, {\n  innerRef: ref\n})));\nMenu.displayName = 'Menu';","map":{"version":3,"sources":["../../../../src/components/Menu/Menu.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __rest } from \"tslib\";\nimport * as React from 'react';\nimport styles from '@patternfly/react-styles/css/components/Menu/menu';\nimport { css } from '@patternfly/react-styles';\nimport { getOUIAProps, getDefaultOUIAId } from '../../helpers';\nimport { MenuContext } from './MenuContext';\nclass MenuBase extends React.Component {\n    constructor() {\n        super(...arguments);\n        this.menuRef = React.createRef();\n        this.activeMenu = null;\n        this.state = {\n            ouiaStateId: getDefaultOUIAId(Menu.displayName),\n            searchInputValue: '',\n            transitionMoveTarget: null\n        };\n        this.handleDrilldownTransition = (event) => {\n            let ref = this.menuRef;\n            if (this.props.innerRef) {\n                ref = this.props.innerRef;\n            }\n            if (!ref.current ||\n                (ref.current !== event.target.closest('.pf-c-menu') &&\n                    !Array.from(ref.current.getElementsByClassName('pf-c-menu')).includes(event.target.closest('.pf-c-menu')))) {\n                return;\n            }\n            if (event.propertyName === 'visibility') {\n                if (this.state.transitionMoveTarget) {\n                    this.state.transitionMoveTarget.focus();\n                    this.setState({ transitionMoveTarget: null });\n                }\n                else {\n                    const nextMenu = ref.current.querySelector('#' + this.props.activeMenu) || ref.current || null;\n                    const nextTarget = Array.from(nextMenu.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')))[0].firstChild;\n                    nextTarget.focus();\n                    nextTarget.tabIndex = 0;\n                }\n            }\n        };\n        this.handleKeys = (event) => {\n            const isDrilldown = this.props.containsDrilldown;\n            let ref = this.menuRef;\n            if (this.props.innerRef) {\n                ref = this.props.innerRef;\n            }\n            if (!ref.current ||\n                (ref.current !== event.target.closest('.pf-c-menu') &&\n                    !Array.from(ref.current.getElementsByClassName('pf-c-menu')).includes(event.target.closest('.pf-c-menu'))) ||\n                event.target.tagName === 'INPUT') {\n                return;\n            }\n            event.stopImmediatePropagation();\n            const activeElement = document.activeElement;\n            if (event.target.closest('.pf-c-menu') !== this.activeMenu &&\n                !event.target.classList.contains('pf-c-breadcrumb__link')) {\n                this.activeMenu = event.target.closest('.pf-c-menu');\n            }\n            const parentMenu = this.activeMenu;\n            const key = event.key;\n            let moveFocus = false;\n            let moveTarget = null;\n            let currentIndex = -1;\n            const validMenuItems = isDrilldown\n                ? Array.from(parentMenu.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')))\n                : Array.from(parentMenu.getElementsByTagName('LI')).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')));\n            const isFromBreadcrumb = activeElement.classList.contains('pf-c-breadcrumb__link') ||\n                activeElement.classList.contains('pf-c-dropdown__toggle');\n            if (key === ' ' || key === 'Enter') {\n                event.preventDefault();\n                if (isDrilldown && !isFromBreadcrumb) {\n                    const isDrillingOut = activeElement.closest('li').classList.contains('pf-m-current-path');\n                    if (isDrillingOut && parentMenu.parentElement.tagName === 'LI') {\n                        activeElement.tabIndex = -1;\n                        parentMenu.parentElement.firstChild.tabIndex = 0;\n                        this.setState({ transitionMoveTarget: parentMenu.parentElement.firstChild });\n                    }\n                    else {\n                        if (activeElement.nextElementSibling && activeElement.nextElementSibling.classList.contains('pf-c-menu')) {\n                            const childItems = Array.from(activeElement.nextElementSibling.getElementsByTagName('UL')[0].children).filter(el => !(el.classList.contains('pf-m-disabled') || el.classList.contains('pf-c-divider')));\n                            activeElement.tabIndex = -1;\n                            childItems[0].firstChild.tabIndex = 0;\n                            this.setState({ transitionMoveTarget: childItems[0].firstChild });\n                        }\n                    }\n                }\n                document.activeElement.click();\n            }\n            if (['ArrowUp', 'ArrowDown'].includes(key)) {\n                validMenuItems.forEach((menuItem, index) => {\n                    if (activeElement.parentElement === menuItem ||\n                        (activeElement.closest('ol') && activeElement.closest('ol').firstChild === menuItem)) {\n                        const increment = key === 'ArrowUp' ? -1 : 1;\n                        currentIndex = index + increment;\n                        if (currentIndex >= validMenuItems.length) {\n                            currentIndex = 0;\n                        }\n                        if (currentIndex < 0) {\n                            currentIndex = validMenuItems.length - 1;\n                        }\n                        moveFocus = true;\n                        moveTarget = validMenuItems[currentIndex].firstChild;\n                        event.preventDefault();\n                    }\n                });\n            }\n            if (['ArrowLeft', 'ArrowRight'].includes(key)) {\n                event.preventDefault();\n                if (isFromBreadcrumb) {\n                    return;\n                }\n                let nextSibling;\n                if (key === 'ArrowLeft') {\n                    nextSibling = activeElement.previousElementSibling;\n                }\n                else {\n                    nextSibling = activeElement.nextElementSibling;\n                }\n                if (nextSibling) {\n                    if (['A', 'BUTTON'].includes(nextSibling.tagName)) {\n                        moveFocus = true;\n                        moveTarget = nextSibling;\n                    }\n                }\n            }\n            if (moveFocus && moveTarget) {\n                activeElement.tabIndex = -1;\n                moveTarget.tabIndex = 0;\n                moveTarget.focus();\n            }\n        };\n    }\n    componentDidMount() {\n        window.addEventListener('keydown', this.props.isRootMenu ? this.handleKeys : null);\n        window.addEventListener('transitionend', this.props.isRootMenu ? this.handleDrilldownTransition : null);\n        let ref = this.menuRef;\n        if (this.props.innerRef) {\n            ref = this.props.innerRef;\n        }\n        const firstItem = ref.current.querySelector('button, a');\n        if (firstItem) {\n            firstItem.tabIndex = 0;\n        }\n    }\n    componentWillUnmount() {\n        window.removeEventListener('keydown', this.handleKeys);\n        window.removeEventListener('transitionend', this.handleDrilldownTransition);\n    }\n    render() {\n        const _a = this.props, { 'aria-label': ariaLabel, id, children, className, onSelect, selected = null, onActionClick, ouiaId, ouiaSafe, containsFlyout, containsDrilldown, isMenuDrilledIn, drilldownItemPath, drilledInMenus, onDrillIn, onDrillOut, onGetMenuHeight, parentMenu = null, activeItemId = null, innerRef, \n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        isRootMenu, \n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        activeMenu } = _a, props = __rest(_a, ['aria-label', \"id\", \"children\", \"className\", \"onSelect\", \"selected\", \"onActionClick\", \"ouiaId\", \"ouiaSafe\", \"containsFlyout\", \"containsDrilldown\", \"isMenuDrilledIn\", \"drilldownItemPath\", \"drilledInMenus\", \"onDrillIn\", \"onDrillOut\", \"onGetMenuHeight\", \"parentMenu\", \"activeItemId\", \"innerRef\", \"isRootMenu\", \"activeMenu\"]);\n        const _isMenuDrilledIn = (isMenuDrilledIn && isMenuDrilledIn) || (drilledInMenus && drilledInMenus.includes(id)) || false;\n        return (React.createElement(MenuContext.Provider, { value: {\n                menuId: id,\n                parentMenu: parentMenu ? parentMenu : id,\n                onSelect,\n                onActionClick,\n                activeItemId,\n                selected,\n                drilledInMenus,\n                drilldownItemPath,\n                onDrillIn,\n                onDrillOut,\n                onGetMenuHeight\n            } },\n            React.createElement(\"div\", Object.assign({ id: id, className: css(styles.menu, containsFlyout && styles.modifiers.flyout, containsDrilldown && styles.modifiers.drilldown, _isMenuDrilledIn && styles.modifiers.drilledIn, className), \"aria-label\": ariaLabel || containsFlyout ? 'Local' : 'Global', ref: innerRef || this.menuRef || null }, getOUIAProps(Menu.displayName, ouiaId !== undefined ? ouiaId : this.state.ouiaStateId, ouiaSafe), props), children)));\n    }\n}\nMenuBase.defaultProps = {\n    ouiaSafe: true,\n    isRootMenu: true\n};\nexport const Menu = React.forwardRef((props, ref) => (React.createElement(MenuBase, Object.assign({}, props, { innerRef: ref }))));\nMenu.displayName = 'Menu';\n//# sourceMappingURL=Menu.js.map"]},"metadata":{},"sourceType":"module"}